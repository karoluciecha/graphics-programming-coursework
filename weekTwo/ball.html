<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Canvas</title>
    <style type="text/css">
      body {
        background-color: white;
      }
      
      canvas {
        border: 1px solid black;
      }

      h1 {
        text-align: center;
      }
    </style>
  </head>
  <body>
    <h1>Karol Uciecha: G00436758</h1>
    <canvas id="canvas" width="500" height="500"></canvas>

    <script type="text/javascript">
      // Canvas dimensions
      const canvasHeight = 500;
      const canvasWidth = 500;

      // Get canvas and drawing context
      let canvas = document.getElementById("canvas");
      let ctx = canvas.getContext("2d");

      // ---------------- BALL CLASS ----------------
      class Ball {
        constructor(xPosition, yPosition, radius, xSpeed, ySpeed, xBounceSpeed = 1, yBounceSpeed = 1) {
          this.xPosition = xPosition;
          this.yPosition = yPosition;
          this.radius = radius;
          this.xSpeed = xSpeed;
          this.ySpeed = ySpeed;
          this.xBounceSpeed = xBounceSpeed;
          this.yBounceSpeed = yBounceSpeed;
        }

        // Draw the ball (circle outline)
        draw() {
          ctx.beginPath();
          ctx.arc(this.xPosition, this.yPosition, this.radius, 0, 2 * Math.PI);
          ctx.stroke();
        }

        // Move the ball and check for wall collisions
        move() {
          this.xPosition += this.xSpeed;
          this.yPosition += this.ySpeed;

          // Bounce off bottom
          if (this.yPosition >= canvasHeight - this.radius) {
            this.resize(); // Random size on bounce
            this.yPosition = canvasHeight - this.radius;
            this.ySpeed *= this.yBounceSpeed;
          }

          // Bounce off top
          if (this.yPosition <= this.radius) {
            this.resize();
            this.yPosition = this.radius;
            this.ySpeed *= this.yBounceSpeed;
          }

          // Bounce off right
          if (this.xPosition >= canvasWidth - this.radius) {
            this.resize();
            this.xPosition = canvasWidth - this.radius;
            this.xSpeed *= this.xBounceSpeed;
          }

          // Bounce off left
          if (this.xPosition <= this.radius) {
            this.resize();
            this.xPosition = this.radius;
            this.xSpeed *= this.xBounceSpeed;
          }
        }

        // Randomly resize ball radius
        resize() {
          this.radius = 5 + Math.floor(Math.random() * 45);
        }
      }

      // ---------------- PACMAN CLASS ----------------
      class PacMan {
        constructor(xPosition, yPosition, radius, rotation, xSpeed, ySpeed, xBounceSpeed = 1, yBounceSpeed = 1, rotationSpeed = 1) {
          this.xPosition = xPosition;
          this.yPosition = yPosition;
          this.radius = radius;
          this.rotation = rotation; // mouth rotation
          this.xSpeed = xSpeed;
          this.ySpeed = ySpeed;
          this.xBounceSpeed = xBounceSpeed;
          this.yBounceSpeed = yBounceSpeed;
          this.rotationSpeed = rotationSpeed; // controls mouth rotation speed
        }

        // Draw PacMan with open mouth
        draw() {
          ctx.beginPath();
          ctx.arc(
            this.xPosition,
            this.yPosition,
            this.radius,
            ((11 * Math.PI) / 6) - this.rotation, // mouth start
            ((1 * Math.PI) / 6) - this.rotation,  // mouth end
            true
          );

          // Draw mouth (two lines)
          ctx.moveTo(this.xPosition, this.yPosition);
          ctx.lineTo(
            this.radius * Math.cos((11 / 6 * Math.PI) - this.rotation) + this.xPosition,
            this.radius * Math.sin((11 / 6 * Math.PI) - this.rotation) + this.yPosition
          );

          ctx.moveTo(this.xPosition, this.yPosition);
          ctx.lineTo(
            this.radius * Math.cos((1 / 6 * Math.PI) - this.rotation) + this.xPosition,
            this.radius * Math.sin((1 / 6 * Math.PI) - this.rotation) + this.yPosition
          );

          ctx.stroke();
        }

        // Move PacMan and check wall collisions
        move() {
          this.xPosition += this.xSpeed;
          this.yPosition += this.ySpeed;
          this.rotate(); // keep rotating

          // Bounce bottom
          if (this.yPosition >= canvasHeight - this.radius) {
            this.resize();
            this.yPosition = canvasHeight - this.radius;
            this.ySpeed *= this.yBounceSpeed;
            this.rotationSpeed *= -1; // flip rotation
          }

          // Bounce top
          if (this.yPosition <= this.radius) {
            this.resize();
            this.yPosition = this.radius;
            this.ySpeed *= this.yBounceSpeed;
            this.rotationSpeed *= -1;
          }

          // Bounce right
          if (this.xPosition >= canvasWidth - this.radius) {
            this.resize();
            this.xPosition = canvasWidth - this.radius;
            this.xSpeed *= this.xBounceSpeed;
            this.rotationSpeed *= -1;
          }

          // Bounce left
          if (this.xPosition <= this.radius) {
            this.resize();
            this.xPosition = this.radius;
            this.xSpeed *= this.xBounceSpeed;
            this.rotationSpeed *= -1;
          }
        }

        // Random resize
        resize() {
          this.radius = 5 + Math.floor(Math.random() * 45);
        }

        // Rotate PacMan mouth
        rotate() {
          this.rotation += this.rotationSpeed * 0.05; // smoother rotation
          if (this.rotation > Math.PI * 2) {
            this.rotation -= Math.PI * 2;
          } else if (this.rotation < 0) {
            this.rotation += Math.PI * 2;
          }
        }
      }

      // ---------------- CREATE OBJECTS ----------------
      const ball = new Ball(50, 10, 5, 5, 10, -1 * Math.random(), -1 * Math.random());
      const pacman = new PacMan(200, 200, 20, 0, 5, 10, -1 * Math.random(), -1 * Math.random());

      // ---------------- ANIMATION LOOP ----------------
      function repeatme() {
        // Clear screen
        ctx.clearRect(0, 0, canvasWidth, canvasHeight);

        // Draw + Move objects
        ball.draw();
        pacman.draw();
        ball.move();
        pacman.move();

        // Loop animation
        window.requestAnimationFrame(repeatme);
      }

      // Start animation
      repeatme();
    </script>
  </body>
</html>
